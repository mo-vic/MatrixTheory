矩阵的分解：乘法

矩阵的分离：加减法



[toc]



# 第一章 线性代数基础

## 第1节 线性空间与子空间

如果数集$P$中任意两个数作某一运算后结果仍在$P$中，我们就称数集$P$对这个运算是封闭的。对加、减、乘、除（除数不为零）四则运算封闭的数集$P$称为数域。

最常见的数域是有理数域$Q$、实数域$R$、复数域$C$​。此外，还有其他很多数域。

==定义1==： 设$V$​​​是一个非空集合，$P$​​​是一个数域。在集合$V$​​​的元素之间定义了一种代数运算，叫做加法：即，给出了一个法则，对于$V$​​​中任意两元$\alpha, \beta$​​​，在$V$​​​中都有==唯一的==一个元$\gamma$​​与它们对应，称$\gamma$​为$\alpha, \beta$​的和，记$\gamma = \alpha + \beta$​。在数域$P$​与集合$V$​的元素之间还定义了一种运算，叫做数量乘法：就是说，对于数域$P$​中任一数$k$​和$V$​中任一元$\alpha$​，在$V$​中都有==唯一元==$\delta$​与它们对应，称$\delta$​为$k$​与$\alpha$​的数量乘积，记为$\delta = k\alpha$​​​。如果加法与数量乘法满足下述规则：

（1）$\alpha + \beta = \beta + \alpha$；

（2）$(\alpha + \beta) + \gamma = a + (\beta + \gamma)$；

（3）在$V$中有一个元$0$，对于$V$中任一元$\alpha$，有$\alpha + 0 = \alpha$（具有这个性质的元$0$称为$V$的零元素）；

（4）对于$V$中每一个元$\alpha$，都有$V$中的元$\beta$，使$\alpha + \beta = 0$（$\beta$称为$\alpha$的负元素，记为$\beta = -\alpha$）；

（5）$1\alpha = \alpha$；

（6）$k(l\alpha) = (kl)\alpha$；

（7）$(k + l)\alpha = k\alpha + l\alpha$；

（8）$k(\alpha + \beta) = k\alpha + k\beta$

则称$V$​为数域$P$​上的线性空间（其中$k, l \in P$​，而$\alpha, \beta \in V$​​），其中的元素常称为==向量==。



规定的某种运算，叫做加法的运算。加法只是一个名字。若加法结果仍处于集合中，则称加法封闭。

规定数域$P$中的某一元素和$V$​中某一元素的某种运算，叫做乘法运算。若乘法结果仍处于集合中，则称乘法封闭。



例1：$R^{n \times n}$：实数域$R$上的线性空间，即元素属于实数域$R$上的$n \times n$型矩阵。它的基是一组线性无关的矩阵。

例2：$R^{n \times n}$中全体对称矩阵构成数域$R$上的线性空间。

例3：数域$R$​​上次数小于等于定数$n(n \ge 0)$​​的多项式全体所构成的集合，是数域$R$​​上的线性空间。



==定义2==：在线性空间$V$​中，如果有$n$​个向量$\epsilon_1, \epsilon_2, \cdots, \epsilon_n$​​线性无关，​而$V$​中任意$n+1$​​个向量线性相关，则称$\epsilon_1, \epsilon_2, \cdots, \epsilon_n$​为$V$​​的一组基底，由于线性空间的所有基底总含有相同数目的向量，$n$​称为线性空间$V$​的维数，常记为$\dim{V} = n$​。



例4：求数域$R$​​​上全体$n$​​​阶方阵构成的空间$R^{n \times n}$​​​的维数与一组基。

解：$\forall_A \in V = R^{n \times n}$，则
$$
A = \left[\begin{array}{cccc}a_{11} &a_{12} &\cdots &a_{1n} \\ a_{21} &a_{22} &\cdots &a_{2n} \\ \vdots &\ddots &\cdots &\vdots \\ a_{n1} &a_{n2} &\cdots &a_{nn}\end{array}\right]
= \left[\begin{array}{c|c}a_{11} &0 \\ \hline \\ 0 &0\end{array}\right]
+ \left[\begin{array}{c|c|c}0 &a_{12} &0 \\ \hline \\ 0 &0 &0\end{array}\right]
+ \cdots
+ \left[\begin{array}{c|c}0 &0 \\ \hline \\ 0 &a_{nn}\end{array}\right] \\
= a_{11}\left[\begin{array}{c|c}1 &0 \\ \hline \\ 0 &0\end{array}\right]
+ a_{12}\left[\begin{array}{c|c|c}0 &1 &0 \\ \hline \\ 0 &0 &0\end{array}\right]
+ \cdots 
+ a_{nn}\left[\begin{array}{c|c}0 &0 \\ \hline \\ 0 &1\end{array}\right]
= a_{11}E_{11} + a_{12}E_{12} + \cdots + a_{nn}E_{nn}
$$
设$k_{11}, k_{12}, \cdots, k_{nn}$使得：
$$
k_{11} E_{11} + k_{12}E_{12} + \cdots + k_{nn}E_{nn} = 0
$$
而
$$
k_{11} E_{11} + k_{12}E_{12} + \cdots + k_{nn}E_{nn} = \left[\begin{array}{cccc}k_{11} &k_{12} &\cdots &k_{1n} \\ k_{21} &k_{22} &\cdots &k_{2n} \\ \vdots &\ddots &\cdots &\vdots \\ k_{n1} &k_{n2} &\cdots &k_{nn}\end{array}\right]
$$
根据矩阵相等的定义和线性无关的定义，可知$R^{n \times n}$的一组基为$E_{11}, E_{12}, \cdots, E_{nn}$，它的维数为$\dim_{R^{n \times n}} = n^2$。



例5：求数域$R$​​​​上全体$n$​​​​阶对称矩阵构成的空间$\{V|A^T=A, \forall_A \in R^{n \times n}\}$​​​​的维数与一组基。

解：$\forall_A \in V$​​，$a_{ij} = a_{ji}$​，


$$
A = \left[\begin{array}{cccc}a_{11} &a_{12} &\cdots &a_{1n} \\ a_{21} &a_{22} &\cdots &a_{2n} \\ \vdots &\ddots &\cdots &\vdots \\ a_{n1} &a_{n2} &\cdots &a_{nn}\end{array}\right]
= \left[\begin{array}{c|c}a_{11} &0 \\ \hline \\ 0 &0\end{array}\right]
+ \left[\begin{array}{c|c|c}0 &a_{12} &0 \\ \hline \\ a_{21} &0 &0 \\ \hline \\ 0 &0 &0\end{array}\right]
+ \cdots
+ \left[\begin{array}{c|c}0 &0 \\ \hline \\ 0 &a_{nn}\end{array}\right] \\
= a_{11}\left[\begin{array}{c|c}1 &0 \\ \hline \\ 0 &0\end{array}\right]
+ a_{12}\left[\begin{array}{c|c|c}0 &1 &0 \\ \hline \\ 1 &0 & 0 \\ \hline \\ 0 &0 &0\end{array}\right]
+ \cdots 
+ a_{nn}\left[\begin{array}{c|c}0 &0 \\ \hline \\ 0 &1\end{array}\right]
= a_{11}E_{11} + a_{12}(E_{12}+E_{21}) + \cdots + a_{nn}E_{nn}
$$
令
$$
F_{ij} = \left\{\begin{array}{ccc}E_{ij} + E_{ji}, &i \neq j &\text{num}=\frac{n^2-n}{2} \\ E_{ii}, & i=j &\text{num}=n\end{array}\right.
$$
设$k_{11}, k_{12}, \cdots, k_{nn}$​使得：
$$
k_{11} F_{11} + k_{12}F_{12} + \cdots + k_{nn}F_{nn} = 0
$$
而
$$
k_{11} F_{11} + k_{12}F_{12} + \cdots + k_{nn}F_{nn} = \left[\begin{array}{cccc}k_{11} &k_{12} &\cdots &k_{1n} \\ k_{21} &k_{22} &\cdots &k_{2n} \\ \vdots &\ddots &\cdots &\vdots \\ k_{n1} &k_{n2} &\cdots &k_{nn}\end{array}\right]
$$
其中$k_{ij} = k_{ji}$。根据矩阵相等的定义和线性无关的定义，可知$\{V|A^T=A, \forall_A \in R^{n \times n}\}$的一组基为$F_{11}, F_{12}, \cdots, F_{nn}$，它的维数为$\dim_{\{V|A^T=A, \forall_A \in R^{n \times n}\}} = \frac{n^2-n}{2}+n = \frac{n(n+1)}{2}$​。



例6：求数域$R$​​​​​上全体$n$​​​​​阶反对称矩阵构成的空间$\{V|A^T=-A, \forall_A \in R^{n \times n}\}$​​​​​的维数与一组基。

解：$\forall_A \in V$​​​，$a_{ij} = -a_{ji}$​​，


$$
A = \left[\begin{array}{cccc}0 &a_{12} &\cdots &a_{1n} \\ a_{21} &0 &\cdots &a_{2n} \\ \vdots &\ddots &\cdots &\vdots \\ a_{n1} &a_{n2} &\cdots &0\end{array}\right]
= \left[\begin{array}{c|c|c}0 &a_{12} &0 \\ \hline \\ a_{21} &0 &0 \\ \hline \\ 0 &0 &0\end{array}\right]
+ \cdots
+ \left[\begin{array}{c|c|c}0 &0 &0 \\ \hline \\ 0 &0 &a_{n-1n} \\ \hline \\ 0 &a_{nn-1} &0\end{array}\right] \\
= a_{12}\left[\begin{array}{c|c|c}0 &1 &0 \\ \hline \\ -1 &0 & 0 \\ \hline \\ 0 &0 &0\end{array}\right]
+ \cdots 
+ a_{n-1n}\left[\begin{array}{c|c|c}0 &0 &0 \\ \hline \\ 0 &0 & 1 \\ \hline \\ 0 &-1 &0\end{array}\right]
= a_{12}(E_{12}-E_{21}) + \cdots + a_{n-1n}(E_{n-1n}-E_{nn-1})
$$
令
$$
F_{ij} = E_{ij} - E_{ji}, i \neq j
$$
设$k_{12}, \cdots k_{n-1n}$​​​使得：
$$
k_{12}F_{12} + \cdots + k_{n-1n}F_{n-1n} = 0
$$
而
$$
k_{12}F_{12} + \cdots + k_{n-1n}F_{n-1n} = \left[\begin{array}{cccc}k_{11} &k_{12} &\cdots &k_{1n} \\ k_{21} &k_{22} &\cdots &k_{2n} \\ \vdots &\ddots &\cdots &\vdots \\ k_{n1} &k_{n2} &\cdots &k_{nn}\end{array}\right]
$$
其中$k_{ij} = -k_{ji}$​​​​。根据矩阵相等的定义和线性无关的定义，可知$\{V|A^T=-A, \forall_A \in R^{n \times n}\}$​​​​的一组基为$F_{12}, \cdots, F_{n-1n}$​​​​，它的维数为$\dim_{\{V|A^T=-A, \forall_A \in R^{n \times n}\}} = \frac{n^2-n}{2}$​​​​。



==定义3==：如果数域$P$上线性空间$V$的一非空子集$W$对于$V$的两种运算也构成线性空间，则称$W$为$V$​的一个线性子空间（简称子空间）。

$\{0\}$和$V$称为平凡子空间，其余的子空间称为非平凡子空间。



例7：设$A \in R^{n \times n}$，证明：全体与$A$可交换的矩阵组成一个子空间，记为$C(A)$。

证：即证$AE = EA \Longrightarrow E \in C(A)$​。

$\forall_{A_1, A_2} \in C(A) \Longrightarrow A_1 A = AA_1, A_2A=AA_2 \Longleftrightarrow (A_1+A_2)A=A(A_1+A_2)$；

$\forall_k \in R, \Longrightarrow (kA_1)A = k(A_1A) = k(AA_1) = A(kA_1)$。证毕！



例8：设$V_1, V_2$​​是线性空间$V$​​的两个非平凡子空间，则$V$​中存在向量$\alpha$​，使$\alpha \notin V_1, \alpha \notin V_2$​​同时成立。==为什么？？==

证：因为$V_1$是非平凡子空间，所以存在向量$\alpha \not \in V_1$，如果$\alpha \not \in V_2$，则结论成立。

如果$\alpha \in V_2$​​，因为$V_2$​​是非平凡子空间，所以存在向量$\beta \not \in V_2$​​​，如果$\beta \not \in V_1$​​，则结论成立。所以如果$\beta \in V_1$，那么$\alpha \not \in V_1, \beta \in V_1, \alpha \in V_2, \beta \not \in V_2$，所以$\gamma = \alpha + \beta \not \in V_1, \gamma = \alpha + \beta \neq V_2$（假设$\gamma = \alpha + \beta \in V_1$，则$\gamma - \beta = \alpha \in V_1$矛盾），证毕！



==特殊的子空间==：设$V_1, V_2$是线性空间$V$的两个子空间，

（1）$V_1$​与$V_2$​的和空间（是包含$V_1$​与$V_2$​的最小子空间）；

证：$\forall_W \subset V$​，即$W$​是$V$​中同时包含$V_1$和$V_2$的任意子空间，也就是$V_1 \subset W, V_2 \subset W$，则$V_1 + V_2 \subset W$（$W$中元素的和当然还在$W$中），由$W$的任意性，可知$V_1 + V_2$是包含$V_1$和$V_2$的最小子空间。

（2）$V_1 \cap V_2 = \{\alpha | \alpha \in V_1, \alpha \in V_2 \}$​（是包含==于==$V_1$​与$V_2$​的最大子空间）；

证：$\forall_W \subset V$​​​​，即$W$​​​​是$V$​​​​中同时被$V_1$​​​​和$V_2$​​​​包含的任意子空间，也就是$W \subset V_1, W \subset V_2$​​​，则$W \subset V_1 \cap V_2$，而$V_1 \cap V_2 \subset V_1, V_1 \cap V_2 \subset V_2$，由$W$的任意性，可知$V_1 \cap V_2$是包含于$V_1$和$V_2$​​​​​的最大子空间。

（3）$\{\alpha | \alpha = \sum_{i=1}^r k_i \alpha_i, \quad \alpha_1, \alpha_2, \cdots, \alpha_r \in V(P)(+,\cdot)\}$（记为$L(\alpha_1, \alpha_2, \cdots, \alpha_r)$或$\operatorname{span}\{\alpha_1, \alpha_2, \cdots, \alpha_r\}$​，称为生成子空间）。





## 第2节 空间分解与维数定理

==定义1==：设$V_1, V_2$​​是线性空间$V$​​的子空间，所谓$V_1$​​和$V_2$​​的和，是指由所有能表示成$\alpha_1 + \alpha_2$​​（$\alpha_1 \in V_1, \alpha_2 \in V_2$​​）的向量组成的集合，记为$V_1 + V_2$​​。

==定义2==：设$V_1, V_2$是线性空间$V$的子空间，则$V_1 \cap V_2 = \{\alpha | \alpha \in V_1, \alpha \in V_2\}$称为$V_1$和$V_2$的交空间。



例1：$V_1 + V_2, V_1 \cap V_2$​均是$V$​的一个子空间。

证明：取向量$v, w \in V_1 \cap V_2$​​​​​​​​​，已知$V_1, V_2$​​​​​​​​​是子空间，则$v + w \in V_1$​​​​​​​​​，$v + w \in V_2$​​​​​​​​​，从而$v + w \in V_1 \cap V_2$​​​​​​​​​。同理$cv \in V_1, cv \in V_2$​​​，从而$cv \in V_1 \cap V_2$​​​。综上有$cv + dw \in V_1 \cap V_2$​​​。因此$V_1 \cap V_2$​​​​​​​​​​​是子空间。

取向量$v = \alpha_1 + \beta_1, w = \alpha_2 + \beta_2 \in V_1 + V_2$​​​，根据定义有$\alpha_1, \alpha_2 \in V_1, \beta_1, \beta_2 \in V_2$​​​，则$v + w = (\alpha_1 + \beta_1) + (\alpha_2 + \beta_2) = (\alpha_1 + \alpha_2) + (\beta_1 + \beta_2)$​​​，而$V_1, V_2$​​​是子空间，有$\alpha_1 + \alpha_2 \in V_1, \beta_1 + \beta_2 \in V_2$​​​，根据定义有$v + w \in V_1 + V_2$​​​。同理$cv = c(\alpha_1 + \beta_1) = c\alpha_1 + c\beta_1$​​​，$c\alpha_1 \in V_1, c\beta_1 \in V_2$​​​，根据定义有$cv \in V_1 + V_2$​​​。综上有$cv + dw \in V_1 + V_2$​​。因此$V_1 + V_2$​​​​​是子空间。



==定理1==：设$V_1, V_2$​​是线性空间$V$​的子空间，则$\dim{V_1} + \dim{V_2} = \dim{(V_1 + V_2)} + \dim{(V_1 \cap V_2)}$​。

证明：假设$\dim{V_1} = s, \dim{V_2} = t, \dim{V_1 \cap V_2} = m$​，要证$\dim{(V_1 + V_2)} = s + t - m$​​。

取$V_1 \cap V_2$​的一组基$(\alpha_1, \alpha_2, \cdots, \alpha_m)$​，所以$V_1 \cap V_2 = L(\alpha_1, \alpha_2, \cdots, \alpha_m)$​，做基扩充可以分别得到$V_1, V_2$的一组基：

$V_1 = L(\alpha_1, \alpha_2, \cdots, \alpha_m, \beta_{m+1}, \cdots, \beta_s), V_2 = L(\alpha_1, \alpha_2, \cdots, \alpha_m, \gamma_{m+1}, \cdots, \gamma_t)$，

$V_1 + V_2 = L(\alpha_1, \alpha_2, \cdots, \alpha_m, \beta_{m+1}, \cdots, \beta_s, \gamma_{m+1}, \cdots, \gamma_t)$​​​​，向量个数为$s+t-m$​。

仍需证明向量组$\alpha_1, \alpha_2, \cdots, \alpha_m, \beta_{m+1}, \cdots, \beta_s, \gamma_{m+1}, \cdots, \gamma_t$是线性无关的。

假设有等式$k_1\alpha_1+k_2\alpha_2+\cdots+k_m\alpha_m+p_{m+1}\beta_{m+1}+p_{m+2}\beta_{m+2}+\cdots+p_s\beta_s+q_{m+1}\gamma_{m+1}+q_{m+2}\gamma_{m+2}+\cdots+q_t\gamma_t=0$，令

$\alpha=k_1\alpha_1+k_2\alpha_2+\cdots+k_m\alpha_m+p_{m+1}\beta_{m+1}+p_{m+2}\beta_{m+2}+\cdots+p_s\beta_s=-q_{m+1}\gamma_{m+1}-q_{m+2}\gamma_{m+2}-\cdots-q_t\gamma_t$，则：

（1）$\alpha=k_1\alpha_1+k_2\alpha_2+\cdots+k_m\alpha_m+p_{m+1}\beta_{m+1}+p_{m+2}\beta_{m+2}+\cdots+p_s\beta_s$，所以$\alpha \in V_1$；

（2）$\alpha=-q_{m+1}\gamma_{m+1}-q_{m+2}\gamma_{m+2}-\cdots-q_t\gamma_t$，所以$\alpha \in V_2$。

因此$\alpha \in V_1 \cap V_2$，即$\alpha=l_1\alpha_1+l_2\alpha_2+\cdots+l_m\alpha_m$。从而$-q_{m+1}\gamma_{m+1}-q_{m+2}\gamma_{m+2}-\cdots-q_t\gamma_t = \alpha = l_1\alpha_1+l_2\alpha_2+\cdots+l_m\alpha_m$，即$l_1\alpha_1+l_2\alpha_2+\cdots+l_m\alpha_m+q_{m+1}\gamma_{m+1}+q_{m+2}\gamma_{m+2}+\cdots+q_t\gamma_t = 0$，因为$\alpha_1, \alpha_2, \cdots, \alpha_m, \gamma_{m+1}, \cdots, \gamma_t$是$V_2$的一组基，所以$\alpha_1, \alpha_2, \cdots, \alpha_m, \gamma_{m+1}, \cdots, \gamma_t$线性无关，从而$l_1=l_2=\cdots=l_m=q_{m+1}=q_{m+2}=\cdots=q_{t}=0$。

因此$\alpha=0$，又因为$\alpha_1, \alpha_2, \cdots, \alpha_m, \beta_{m+1}, \cdots, \beta_s$是$V_1$的一组基，所以$\alpha_1, \alpha_2, \cdots, \alpha_m, \beta_{m+1}, \cdots, \beta_s$线性无关，从而$k_1=k_2=\cdots=k_m=p_{m_1}=p_{m+2}=\cdots=p_s=0$。综上可知向量组$\alpha_1, \alpha_2, \cdots, \alpha_m, \beta_{m+1}, \cdots, \beta_s, \gamma_{m+1}, \cdots, \gamma_t$是线性无关的。



==定义3==：设$V_1, V_2$​是线性空间$V$​的子空间，若对$\forall_{\alpha} \in V_1 + V_2$​，有$\alpha = \alpha_1 + \alpha_2$​（$\alpha_1 \in V_1, \alpha_2 \in V_2$​），且这种表示是==唯一的==，这个和$V_1 + V_2$​就称为直和，记为$V_1 \oplus V_2$​。



如何降低直和的判断依据（直和的简洁判据）？

==定理2==：设$V_1, V_2$是线性空间$V$的子空间，则下面几条命题相互等价：

（1）$V_1 + V_2$​是直和；

（2）零向量表示法唯一。即由$0 = \alpha_1 + \alpha_2$​（$\alpha_i \in V_i$​​），必有$\alpha_1 = 0, \alpha_2 = 0$​。

（3）$V_1 \cap V_2 = \{0\}$​​（最常用的方法）。



证：（1）$\Longleftarrow$（3）（反证法）：设$V_1 + V_2$不是直和，则存在$\beta_1 + \beta_2 = \gamma = \alpha_1 + \alpha_2$，其中$\alpha_1, \beta_1 \in V_1, \alpha_2,\beta_2 \in V_2, \alpha_1 \neq \beta_1, \alpha_2 \neq \beta_2$，所以$\beta_1 - \alpha_1 = \alpha_2 - \beta_2$，令$\tau = \beta_1-\alpha_1=\alpha_2-\beta_2 \in V_1 \cap V_2$，则$\tau \neq 0$，出现矛盾！

（1）$\Longrightarrow$​​（3）（反证法）：假设$V_1 \cap V_2 \neq \{0\}$​，则一定存在$\tau \neq 0 \in V_1 \cap V_2$​，而$V_1 \cap V_2 \subset V_1, V_1 \cap V_2 \subset V_2$​，所以有$\tau \in V_1, -\tau \in V_2$，另取$0 \in V_1, 0 \in V_2$，从而零的分解式$0 + 0 = 0 = \tau + (-\tau)$，其表示不唯一，与$V_1+V_2$是直和矛盾！



==推论1==：设$V_1, V_2$​是$V$​的子空间。令$W = V_1 \oplus V_2$​，则$W = V_1 \oplus V_2 \leftrightarrow \dim{W} = \dim{V_1} + \dim{V_2}$​。



==定义4==：设$V_1, V_2,\cdots,V_s$是线性空间$V$的子空间，如果和$V_1+V_2+\cdots+V_s$中每个向量$\alpha$的分解式$\alpha=\alpha_1+\alpha_2+\cdots+\alpha_s,\alpha_i \in V_i, (i=1,2,\cdots,s)$是唯一的，这个和$V_1+V_2+\cdots+V_s$就称为直和，记为$V_1 \oplus V_2 \oplus \cdots \oplus V_s$。

==定理3==：设$V_1, V_2,\cdots,V_s$是线性空间$V$的子空间，则下列命题等价：

（1）$W = V_1+V_2+\cdots+V_s$是直和；

（2）零向量的表示法唯一；

（3）$V_i \cap (\sum_{j \neq i}V_j) = \{0\}$；

（4）$\dim_W = \sum \dim_{V_i}$。



例2：设$\alpha, \beta$​是线性空间$V$​中的两个线性无关的元，则$L(\alpha) + L(\beta)$​是直和，而$L(\alpha, \alpha + \beta) + L(\beta)$​不是直和（其中$L(\alpha, \beta)$​是由$\alpha, \beta$​生成的子空间）。

证：$L(\alpha) = \{\gamma|\gamma = k\alpha\}, L(\beta)=\{\gamma|\gamma=l\beta\}$，$\forall_\tau \in L(\alpha) \cap L(\beta)$，$k\alpha = \tau = l\beta$，即$k\alpha-l\beta = 0$，由于$\alpha, \beta$线性无关，所以$k=l=0$，从而$\tau = 0$，由$\tau$的任意性，有$L(\alpha) \cap L(\beta) = \{0\}$，所以$L(\alpha) + L(\beta)$是直和。

取$v = -\alpha + (\alpha + \beta) = \beta \in L(\alpha, \alpha + \beta), w = -\beta \in L(\beta)$​，则$v + w = \beta - \beta = 0$​，即零元的分解式不唯一，故$L(\alpha, \alpha + \beta) + L(\beta)$​​​不是直和。



例3：设$V = R^{n \times n}, V_1=\{V|A^T=A, \forall_A \in R^{n \times n}\}, V_2=\{V|A^T=-A, \forall_A \in R^{n \times n}\}$​，则$V_1 + V_2 = V$​。

证：$V_1 \cap V_2 = \{A^T = A = -A, \forall_A \in R^{n \times n}\}$​，所以$V_1 \cap V_2 = \{0\}$​，所以$V_1 + V_2$​是直和。$\forall_A \in R^{n \times n}$，$A = \frac{1}{2}(A + A^T) + \frac{1}{2}(A - A^T)$，其中令$B = A + A^T, C = A - A^T$，则$B^T = B \in V_1, C^T = -C \in V_2$，证毕。



## 第3节 特征值和特征向量

### 一、特征值和特征值的概念

在线性代数：矩阵$\rightarrow$特征多项式

逆问题：多项式$\rightarrow$矩阵（控制论常用）

==定义1==：设$A \in C^{n \times n}$，如果存在$\lambda \in C$和==非零向量==$x \in C^n$，使得$Ax = \lambda x$​，则$\lambda$叫做$A$的特征值，$x$叫做$A$的属于特征值$\lambda$的特征向量。



（1）矩阵$A$的谱：$A$的全体特征值，叫做$A$的谱，记为$\lambda(A)$。根据定义，$\lambda \in \lambda(A)$的充要条件是$\det (\lambda E-A) = 0$。

（2）$V_{\lambda_i} = \{x | Ax = \lambda_i x\}$为$A$的属于特征值$\lambda_i$的特征子空间。

（3）特征多项式：$P_n(\lambda)=\det(\lambda E - A)$。

1. 令$\lambda = 0$，可得$P_n(\lambda)$的常数项为$(-1)^n \det(A)$；
2. 显然$\lambda^n$和$\lambda^{n-1}$均来自对角线的乘积，即$(\lambda-a_{11})(\lambda-a_{22})\cdots(\lambda-a_{nn})$，当每一项都取$\lambda$时，得$\lambda^n$；第一项取$-a_{11}$，其余项取$\lambda$，得到$-a_{11}\lambda^{n-1}$，第二项取$-a_{22}$，其余项取$\lambda$，得到$-a_{22}\lambda^{n-1}$……，把所有的结果都加起来，得到$-(a_{11}+a_{22}+\cdots+a_{nn})\lambda^{n-1}$。

$$
P_n(\lambda) = \det(\lambda E-A) \\
= \left|\begin{array}{cccc}\lambda-a_{11} &-a_{12} &\cdots &-a_{1n} \\ -a_{22} &\lambda-a_{22} &\cdots &-a_{2n} \\ \vdots &\cdots &\ddots &\vdots \\-a_{n1} &-a_{n2} &\cdots &\lambda-a_{nn}\end{array}\right| \\
=\lambda^n - (a_{11} + a_{22} + \cdots + a_{nn})\lambda^{n-1} + \cdots + (-1)^n |A|
$$

3. 特征多项式$P_n(\lambda)=\det(\lambda E - A)=(\lambda-\lambda_1)(\lambda-\lambda_2)\cdots(\lambda-\lambda_n)$，将式子展开，可得$P_n(\lambda)=\det(\lambda E - A) = \lambda^n - (\lambda_1 + \lambda_2 + \cdots + \lambda_n)\lambda^{n-1} + (-1)^n \prod_{i=1}^n \lambda_i$，对比上述两个式子的系数，可以得出两个结论：

（4）$\sum_{i=1}^n a_{ii} = \sum_{i=1}^n \lambda_i = \tr(A)$。

（5）$\det(A) = \prod_{i=1}^n \lambda_i$。



将特征多项式中具有相同特征值的项进行合并，则$P_n(\lambda)=\det(\lambda E - A)=(\lambda-\lambda_1)(\lambda-\lambda_2)\cdots(\lambda-\lambda_n) = (\lambda-\lambda_1)^{n_1}(\lambda-\lambda_2)^{n_2}\cdots(\lambda-\lambda_r)^{n_r}$，其中$\sum_{i=1}^r n_i = n$。

称：

（6）$n_i$称为特征值$\lambda_i$的代数重数。

（7）$m_i = \dim_{V_{\lambda_i}} = n - \rank(\lambda_i E - A)$称为特征值$\lambda_i$的几何重数，它表示$A$的属于特征值$\lambda_i$的线性无关的特征向量的个数。



（8）不同特征值对应的特征向量线性无关。

证：设$\lambda_i, (i=1,2,\cdots,r)$为互异的特征值，$x_1^{(i)}, x_2^{(i)}, \cdots, x_{s_i}^{(i)}$为$\lambda_i$对应的线性无关特征向量$(i=1,2,\cdots,r)$，要证$\underbrace{x_{1}^{(1)}, x_{2}^{(1)}, \cdots, x_{s_{1}}^{(1)}}, \underbrace{x_{1}^{(2)}, x_{2}^{(2)}, \cdots, x_{s_{2}}^{(2)}}, \cdots , \underbrace{x_{1}^{(r)}, x_{2}^{(r)}, \cdots, x_{s_{r}}^{(r)}}$线性无关。

令$\underbrace{k_{11} x_{1}^{(1)}+\cdots+k_{1 s_{1}} x_{s_{1}}^{(1)}}+\underbrace{k_{21} x_{1}^{(2)}+\cdots+k_{2 s_{2}} x_{s_{2}}^{(2)}}+\cdots+\underbrace{k_{r 1} x_{1}^{(r)}+\cdots+k_{r s_{r}} x_{s_{r}}^{(r)}}=0$（记为（A）式），等式两边同时乘以$(\lambda_1 E - A)$得：

$\left(\lambda_{1} E-A\right)(\underbrace{k_{11} x_{1}^{(1)}+\cdots+k_{1 s_{1}} x_{s_{1}}^{(1)}}+\underbrace{k_{21} x_{1}^{(2)}+\cdots+k_{2 s_2} x_{s_{2}}^{(2)}}+\cdots+\underbrace{k_{r 1} x_{1}^{(r)}+\cdots+k_{r s_{r}} x_{s_{r}}^{(r)}})=0$，即

$\left(\lambda_{1}-\lambda_{2}\right)(\underbrace{k_{21} x_{1}^{(2)}+\cdots+k_{2 s_2}x_{s_{2}}^{(2)})}+\cdots+(\lambda_{1}-\lambda_{r}) \underbrace{(k_{r 1} x_{1}^{(r)}+\cdots+k_{r s_{r}}x_{s_{r}}^{(r)}})=0$，等式两边同时乘以$(\lambda_2 E - A)$得：

$(\lambda_2 E - A)[\left(\lambda_{1}-\lambda_{2}\right)(\underbrace{k_{21} x_{1}^{(2)}+\cdots+k_{2 s_2}x_{s_{2}}^{(2)})}+\cdots+(\lambda_{1}-\lambda_{r}) \underbrace{(k_{r 1} x_{1}^{(r)}+\cdots+k_{r s_{r}}x_{s_{r}}^{(r)}})] = 0$，即$\left(\lambda_{1}-\lambda_{3}\right)\left(\lambda_{2}-\lambda_{3}\right)(\underbrace{k_{31} x_{1}^{(3)}+\cdots+k_{3 s_{3}} x_{s_{3}}^{(3)})}+\cdots+\left(\lambda_{1}-\lambda_{r}\right)\left(\lambda_{2}-\lambda_{r}\right) \underbrace{(k_{r 1} x_{1}^{(r)}+\cdots+k_{r s_{r}} x_{s_{r}}^{(r)})}=0$

………………………………

$(\lambda_1-\lambda_r)(\lambda_2-\lambda_r)\cdots(\lambda_{r-1}-\lambda_r)(k_{r1}x_{1}^{(r)} + \cdots + k_{r s_{r}}x_{s_{r}}^{(r)}) = 0$，由于$\lambda_i, (i=1,2,\cdots,r)$是互异特征值，则$k_{r1}x_{1}^{(r)} + \cdots + k_{r s_{r}}x_{s_{r}}^{(r)} = 0$，又由于$x_1^{(r)}, \cdots, x_{s_r}^{(r)}$线性无关，所以$k_{r1} = \cdots = k_{rs_{r}} = 0$。

将$k_{r1} = \cdots = k_{rs_{r}} = 0$代入（A）式后，重复上述的步骤，可以求得：$k_{11} = \cdots k_{1 s_{1}} = k_{21} = \cdots k_{2 s_{2}} = \cdots = k_{r1} = \cdots = k_{r s_{r}} = 0$，从而$\underbrace{x_{1}^{(1)}, x_{2}^{(1)}, \cdots, x_{s_{1}}^{(1)}}, \underbrace{x_{1}^{(2)}, x_{2}^{(2)}, \cdots, x_{s_{2}}^{(2)}}, \cdots , \underbrace{x_{1}^{(r)}, x_{2}^{(r)}, \cdots, x_{s_{r}}^{(r)}}$线性无关。



（9）特征值的几何重数不超过代数重数。

证：设$V_{\lambda_0} = \{x | (\lambda_0 E - A)x = 0\}$，$\dim_{V_{\lambda_0}} = k$，且$x_1, x_2, \cdots, x_k$为$V_{\lambda_0}$的基。

将$V_{\lambda_0}$的基$x_1, x_2, \cdots, x_k$扩充为$C^n$的基$x_1, x_2, \cdots, x_k, x_{k+1}, \cdots, x_n$。令矩阵$C = (x_1, x_2, \cdots, x_k, x_{k+1}, \cdots, x_n)$，则矩阵$C$可逆，即$E_n = C^{-1}C = C^{-1}(x_1, x_2, \cdots, x_k, x_{k+1}, \cdots, x_n)$。令$e_k = (0, \cdots, 1_{[k]}, 0, \cdots, 0)^T, (k=1,2,\cdots,n)$，则$(e_1, e_2, \cdots, e_n) = (C^{-1}x_1, C^{-1}x_2, \cdots, C^{-1}x_n)$。
$$
C^{-1}AC = C^{-1}A(x_1, x_2, \cdots, x_k, x_{k+1}, \cdots, x_n) \\
= C^{-1}(Ax_1, Ax_2, \cdots, Ax_k, Ax_{k+1}, \cdots, Ax_n) \\
= C^{-1}(\lambda_0 x_1, \lambda_0 x_2, \cdots, \lambda_0 x_k, Ax_{k+1}, \cdots, Ax_n) \\
= (\lambda_0 C^{-1}x_1, \lambda_0 C^{-1}x_2, \cdots, \lambda_0 C^{-1}x_k, C^{-1}Ax_{k+1}, \cdots, C^{-1}Ax_n) \\
= (\lambda_0 e_1, \lambda_0 e_2, \cdots, \lambda_0 e_k, C^{-1}Ax_{k+1}, \cdots, C^{-1}Ax_n) \\
= \left[\begin{array}{ccc|c} \lambda_0 & & &* \\ \ &\ddots & \\ \ & &\lambda_0 \\ \hline \\ \ &0 & &A_0\end{array}\right]
$$
由
$$
C^{-1}AC = \left[\begin{array}{ccc|c} \lambda_0 & & &* \\ \ &\ddots & \\ \ & &\lambda_0 \\ \hline \\ \ &0 & &A_0\end{array}\right] = B
$$
可知
$$
\det(\lambda E - A) = \det(\lambda E - B) = \left|\begin{array}{ccc|c} \lambda-\lambda_0 & & &* \\ \ &\ddots & \\ \ & &\lambda-\lambda_0 \\ \hline \\ \ &0 & &\lambda E_{n-k}-A_0\end{array}\right| \\
= (\lambda-\lambda_0)^k \det(\lambda E_{n-k} - A)
$$
因此$\lambda_0$至少为$k$重特征值，$k = \dim_{V_{\lambda_0}}$为几何重数，证毕！



==定义2==：设$A \in C^{n \times n}$，如果存在可逆矩阵$P \in C^{n \times n}$，使得$P^{-1}AP = \operatorname{diag}(\lambda_1, \lambda_2, \cdots, \lambda_n)$，则矩阵$A$叫做可对角化矩阵。



**注**：$n$阶矩阵$A$可对角化$\Longleftrightarrow$$A$有$n$个线性无关的特征向量。



==定理1==：设$A \in C^{n \times n}$有$r$个不同的特征值$\lambda_1, \cdots, \lambda_r$，其代数重数分别为$n_1, \cdots, n_r$，则必存在可逆矩阵$P \in C^{n \times n}$，使得
$$
P^{-1}AP = J = \operatorname{diag}(J_{n_1}(\lambda_1), \cdots, J_{n_r}(\lambda_r)) \\
= \left[\begin{array}{c|c|c|c}J_{n_1} (\lambda_1) \\ \hline \\ \ &J_{n_2}(\lambda_2) \\ \hline \\ \ &\ &\ddots \\ \hline \\ \ &\ &\ &J_{n_r}(\lambda_r)\end{array}\right]
$$
其中，
$$
J_{n_i}(\lambda_i) = \left[\begin{array}{c}\lambda_i &1 \\ \ &\lambda_i &1 \\ \ &\ &\ddots &\ddots \\ \ &\ &\ &\lambda_i &1 \\ \ &\ &\ &\ &\lambda_i\end{array}\right]
$$
称为Jordan块。

则：

（1）矩阵$J$叫做$A$的Jordan标准形。

（2）其中$\lambda_1, \lambda_2, \cdots, \lambda_r$可能相同。



Jordan矩阵的结构与几个结论：

（1）Jordan块的个数$r$是线性无关的特征向量的个数；

（2）矩阵可对角化，当且仅当$r = n$；

（3）对应于同一特征值的Jordan块的个数是该特征值的几何重数，它是相应的特征子空间的维数。对应于同一特征值的所有Jordan块的阶数之和是该特征值的代数重数。



==定理2==：设$A \in C^{n \times n}$，则下列命题等价：

（1）$A$是可对角化矩阵；

（2）$C^n$存在由$A$的特征向量构成的一组基底；

（3）$A$的Jordan标准形中的Jordan块都是一阶的；

（4）$m_i = n_i, (i=1,2,\cdots,r)$。



==控制论反问题==：已知$Q(\lambda) = \lambda^n + a_1\lambda^{n-1}+\cdots+a_{n-1}\lambda + a_n$，求矩阵$A$（友矩阵或相伴矩阵），使$P_n(\lambda) = \det(\lambda E - A) = Q(\lambda)$。

令
$$
A = \left[\begin{array}{cccccc}0 &\ &\ &\ &\ &-a_n \\ 1 &0 &\ &\ &\ &-a_{n-1} \\ \ &1 &0 &\ &\ &-a_{n-2} \\ \ &\ &\ddots &\ddots &\ &\vdots \\ \ &\ &\ &\ &1 &-a_1\end{array}\right]
$$
则
$$
P_n(\lambda) = \det(\lambda E - A) \\
= \left[\begin{array}{cccccc}\lambda &\ &\ &\ &\ &a_n \\ -1 &\lambda &\ &\ &\ &a_{n-1} \\ \ &-1 &\lambda &\ &\ &a_{n-2} \\ \ &\ &\ddots &\ddots &\ &\vdots \\ \ &\ &\ &\ &-1 &\lambda+a_1\end{array}\right]
$$
将行列式按第一行进行展开，得
$$
P_n(\lambda) = \det(\lambda E - A) = D_n \\
= \left|\begin{array}{cccccc}\lambda &\ &\ &\ &\ &a_n \\ -1 &\lambda &\ &\ &\ &a_{n-1} \\ \ &-1 &\lambda &\ &\ &a_{n-2} \\ \ &\ &\ddots &\ddots &\ &\vdots \\ \ &\ &\ &\ &-1 &\lambda+a_1\end{array}\right| \\
= \lambda \left|\begin{array}{cccccc}\lambda &\ &\ &\ &\ &a_{n-1} \\ -1 &\lambda &\ &\ &\ &a_{n-2} \\ \ &-1 &\lambda &\ &\ &a_{n-3} \\ \ &\ &\ddots &\ddots &\ &\vdots \\ \ &\ &\ &\ &-1 &\lambda+a_1\end{array}\right| + a_n (-1)^{1+n}(-1)^{n-1} \\
= \lambda D_{n-1} + a_n
$$
将$D_{n-1}$继续展开，有：

$P_n(\lambda) = \lambda(\lambda D_{n-2} + a_{n-1}) + a_n = \lambda^2 D_{n-2} + a_{n-1}\lambda + a_n = \cdots = \lambda^{n-1}(\lambda+a_1)+\cdots+a_{n-1}\lambda + a_n = Q(\lambda)$。



### 二、特征值和特征向量的几何性质

#### 2.1 变换

设$V_{(P)}(+, \cdot)$是一线性空间，定义一种对应关系$T$，使得$\forall_\alpha \in V, \alpha \overset{T}{\to} a^\prime \in V$，即$V$中任一元素$\alpha$，在$T$下都有$V$中唯一确定的元素$\alpha^\prime$与之对应，则称$T$为$V$的变换。

**注**：若$T$是不同集合上元素的对应，一般称为对应或算子。

#### 2.2 线性变换

若$T$为$V$的变换，且满足：

（1）$\forall_{\alpha, \beta} \in V, T(\alpha + \beta) = T(\alpha)+T(\beta)$；

（2）$\forall_k \in P, T(k\alpha) = kT(\alpha)$，

则称$T$为$V$的线性变换。



例1：设$V = \{\alpha|\alpha=(x,y)^T, x, y \in R\} = R^2$，$A = \left[\begin{array}{cc}\cos\theta &-\sin\theta \\ \sin\theta &\cos\theta\end{array}\right]$（Givens旋转），$T\alpha = A\alpha \in V = R^2$。

验证：

（1）$\forall_{\alpha,\beta} \in V, T(\alpha + \beta) = A(\alpha+\beta) = A\alpha+A\beta = T\alpha+T\beta$

（2）$\forall_k \in R, \forall_\alpha \in V$，$T(k\alpha) = A(k\alpha) = k(A\alpha) = kT\alpha$



例2：在线性空间$P_n$（次数不超过$n$的多项式所构成的集合）中，求微分是线性变换。

验证：$V = P_n(x)$，$T = D$（求导运算），即$\forall_{f(x)} \in V$，$Tf(x) = Df(x) = f^\prime(x) \in V$。

$\forall_{f(x), g(x)} \in V, \forall_{k, l} \in P$，$T[kf(x)+lg(x)] = [kf(x)+lg(x)]^\prime = kf^\prime(x) + lg^\prime(x) = kTf(x)+lTg(x)$。



例3：在线性空间$V = C[a, b]$（闭区间$[a, b]$上所有连续函数所组成的集合）中，求定积分是线性变换。

验证：$\forall_{f(x)} \in V, Tf(x) = \int_a^x f(t)dt \in D[a, b] \subset C[a, b]$。

$T[kf(x)+lg(x)] = \int_0^x kf(t)+lg(t)dt = k\int_0^x f(t)dt + l\int_0^x g(t)dt = kTf(x)+lTg(x)$。



#### 2.3 线性变换的特征值

==定义1==：设$T$是线性空间$V_n(C)$的一个线性变换，如果存在$\lambda \in C$和非零向量$\xi \in V_n(C)$，使得$T\xi = \lambda \xi$，则$\lambda$叫做$T$的特征值，$\xi$叫做$T$的属于特征值$\lambda$的特征向量。



#### 2.4 线性变换与矩阵（$T \underset{1 \leftrightarrow 1}{\overset{\epsilon_1,\epsilon_2,\cdots,\epsilon_n}{\Longrightarrow}}A$）

设$V_n(P)$是数域$P$上的$n$维线性空间，$\epsilon_1, \epsilon_2, \cdots, \epsilon_n$为基，$T$是$V_n(P)$上的线性变换，即
$$
V &\overset{T}{\to} &V \\
\downarrow &线性变换 &\downarrow \\
\xi_i &\overset{T}{\to} &T\xi_i = \sum_{j=1}^n a_j\epsilon_j
$$
有$T\epsilon_1 = \sum_{i=1}^n a_{i1}\epsilon_i, T\epsilon_2 = \sum_{i=1}^n a_{i2}\epsilon_i, \cdots, T\epsilon_n = \sum_{i=1}^n a_{in}\epsilon_i$，令
$$
T(\epsilon_1, \epsilon_2, \cdots, \epsilon_n) \triangleq (T\epsilon_1, T\epsilon_2, \cdots, T\epsilon_n) \\
= [\epsilon_1, \epsilon_2, \cdots, \epsilon_n]\left[\begin{array}{cccc}a_{11} &a_{12} &\cdots &a_{1n} \\ a_{21} &a_{22} &\cdots &a_{2n} \\ \vdots &\vdots &\ddots &\vdots \\ a_{n1} &a_{n2} &\cdots &a_{nn}\end{array}\right] \\
= [\epsilon_1, \epsilon_2, \cdots, \epsilon_n]A
$$
称矩阵$A$为线性变换$T$在基$\epsilon_1, \epsilon_2, \cdots, \epsilon_n$下的矩阵。


$$
\xi &\searrow & &\nearrow &x=[x_1, x_2, \cdots, x_n]^T \\
T\downarrow & & \epsilon_1, \epsilon_2, \cdots, \epsilon_n & &\downarrow A \\
\eta &\nearrow & &\searrow &y=[y_1, y_2,\cdots,y_n]^T
$$

$$
[\epsilon_1, \epsilon_2, \cdots, \epsilon_n] y = \eta = T\xi = T(\sum_{i=1}^n x_i\epsilon_i) = \sum_{i=1}^n x_i T\epsilon_i \\
= [T\epsilon_1, T\epsilon_2, \cdots, T\epsilon_n]x = [\epsilon_1, \epsilon_2, \cdots, \epsilon_n]Ax
$$

因为$\epsilon_1, \epsilon_2, \cdots, \epsilon_n$是基，所以$[\epsilon_1, \epsilon_2, \cdots, \epsilon_n]$可逆，从而$y = Ax$。

==结论==：$\eta = T\xi \Longleftrightarrow y = Ax$。



#### 2.5 线性变换与矩阵特征值的关系

$$
\xi &\searrow & &\nearrow &x=[x_1, x_2, \cdots, x_n]^T \\
T\downarrow & & \epsilon_1, \epsilon_2, \cdots, \epsilon_n & &\downarrow A \\
\lambda\xi=\eta=T\xi &\nearrow & &\searrow &y=[y_1,y_2,\cdots,y_n]=\lambda x
$$

$$
[\epsilon_1, \epsilon_2, \cdots, \epsilon_n] \lambda x = \sum_{i=1}^n \lambda x_i\epsilon_i = \lambda\sum_{i=1}^n x_i\epsilon_i = \lambda\xi = T\xi \\
= T(\sum_{i=1}^n x_i\epsilon_i) = \sum_{i=1}^n x_i T\epsilon_i \\
= [T\epsilon_1, T\epsilon_2, \cdots, T\epsilon_n]x = [\epsilon_1, \epsilon_2, \cdots, \epsilon_n]Ax
$$

即得$\lambda x = Ax$。

==结论==：$T\xi = \lambda \xi \Longleftrightarrow Ax = \lambda x$。



#### 2.6 线性变换在不同基下矩阵之间的关系

设$V_n(P)$是数域$P$上的$n$维线性空间，$V_n(P) = L(\epsilon_1, \epsilon_2, \cdots, \epsilon_n)$，可以选取不同的$n$个线性无关的向量作为该线性空间的基，而不同的基对应不同的矩阵$A$，它们之间有什么联系？？
$$
A \overset{\epsilon_1, \epsilon_2, \cdots, \epsilon_n}{\Longleftrightarrow} T \overset{\epsilon_1^\prime, \epsilon_2^\prime, \cdots, \epsilon_n^\prime}{\Longleftrightarrow} B
$$
已知：
$$
T(\epsilon_1, \epsilon_2, \cdots, \epsilon_n) \triangleq [\epsilon_1, \epsilon_2, \cdots, \epsilon_n]A \\
T(\epsilon_1^\prime, \epsilon_2^\prime, \cdots, \epsilon_n^\prime) \triangleq [\epsilon_1^\prime, \epsilon_2^\prime, \cdots, \epsilon_n^\prime]B \\
[\epsilon_1^\prime, \epsilon_2^\prime, \cdots, \epsilon_n^\prime] = [\epsilon_1, \epsilon_2, \cdots, \epsilon_n]C
$$

$$
[\epsilon_1, \epsilon_2, \cdots, \epsilon_n]CB = [\epsilon_1^\prime, \epsilon_2^\prime, \cdots, \epsilon_n^\prime]B = T(\epsilon_1^\prime, \epsilon_2^\prime, \cdots, \epsilon_n^\prime) = T([\epsilon_1, \epsilon_2, \cdots, \epsilon_n]C) \\
= [T(\epsilon_1, \epsilon_2, \cdots, \epsilon_n)]C = [\epsilon_1, \epsilon_2, \cdots, \epsilon_n]AC
$$

即$[\epsilon_1, \epsilon_2, \cdots, \epsilon_n](CB-AC) = 0$，由于$\epsilon_1, \epsilon_2, \cdots, \epsilon_n$是一组基，所以$\epsilon_1, \epsilon_2, \cdots, \epsilon_n$线性无关，从而$CB-AC = 0$，$AC = CB \Longrightarrow B = C^{-1}AC$。



例4：在线性空间$V = P_n[x] = \{a_0 + a_1x + a_2x^2 + \cdots + a_{n-1}x^{n-1} + a_nx^n\}$（次数不超过$n$的多项式所构成的集合）中，$T = D$为求导运算。

$V$的一组基为$\{1, x, x^2, \cdots, x^{n-1}, x^n\} = \{\epsilon_1, \epsilon_2, \cdots, \epsilon_{n-1}, \epsilon_n\}$；

考虑$V$的另一组基：

$\forall_{f(x)} \in V$，$f(x) = f(0) + f^\prime(0)x + \frac{f^{\prime\prime}(0)}{2!}x^2 + \cdots + \frac{f^{(n-1)}(0)}{(n-1)!}x^{n-1} + \frac{f^{(n)}(\xi)}{n!}x^n$，则$V$的另一组基为$\{1, x, \frac{1}{2!}x^2, \cdots, \frac{1}{n!}x^n\} = \{\epsilon_1^\prime, \epsilon_2^\prime, \cdots, \epsilon_n^\prime\}$。



考虑两组基下的矩阵：
$$
T(1, x, x^2, \cdots, x^{n-1}, x^n) \overset{求导}{=} \{0, 1, 2x, \cdots, (n-1)x^{n-2}, nx^{n-1}\} \\
= [1, x, x^2, \cdots, x^{n-1}, x^n]\left[\begin{array}{cccccc}0 &1 \\ 0 &0  &2 \\ 0 &0 &0 &\ddots \\ \vdots  &\cdots &\cdots &\cdots &\ddots \\ 0 &0 &0 &0 &\cdots &n \\ 0 &0 &0 &0 &\cdots &0 \end{array}\right]
$$

$$
T(1, x, \frac{x^2}{2!}, \cdots, \frac{x^{n-1}}{(n-1)!}, \frac{x^n}{n!}) \overset{求导}{=} \{0, 1, x, \cdots, \frac{x^{n-1}}{(n-1)!}\} \\
= [1, x, \frac{x^2}{2!}, \cdots, \frac{x^{n-1}}{(n-1)!}, \frac{x^n}{n!}]\left[\begin{array}{cccccc}0 &1 \\ 0 &0  &1 \\ 0 &0 &0 &\ddots \\ \vdots  &\cdots &\cdots &\cdots &\ddots \\ 0 &0 &0 &0 &\cdots &1 \\ 0 &0 &0 &0 &\cdots &0 \end{array}\right]
$$



### 三、广义特征值问题

设$x = [x_1, x_2, \cdots, x_n]^T \in R^n, A,B \in R^{n \times n}$，$f(x) = x^TAx$，求$\min{f(x) = x^TAx}, s.t. \ x^TBx = 1$。

构造拉格朗日函数，把约束条件作为惩罚项，$F(x, \lambda) = x^TAx - \lambda(x^TBx - 1)$，则$\nabla_x F = 2Ax - 2\lambda Bx$。令$\nabla_x F = 0$，即$2(Ax - \lambda Bx) = 0$，移项得$Ax = \lambda Bx$。由$x^TBx = 1$可知，$x \neq 0$。

（1）$Ax = \lambda Bx, x \neq 0$为广义特征值问题；

（2）当$B = E$时，$Ax = \lambda x$为特征值问题。



==定义1==：设$A, B \in C^{n \times n}$，如果存在$\lambda \in C$和非零向量$x \in C^{n}$，使得$Ax = \lambda Bx$，则称$\lambda$为矩阵$A$与$B$确定的广义特征值，$x$称为与$\lambda$对应的广义特征向量。

==定义2==：若$A = A^H, B = B^H$且$B$正定，则称矩阵$A, B$构成正则矩阵束，记为$(A, B)$。

==定义3==：$A^H = \overline{A^T}$，即对$A$进行转置运算后再对每个元素取共轭复数。

若$A \in R^{n \times n}$，则$A^H = A \Longleftrightarrow \overline{A^T} = A \Longleftrightarrow A^T = A$。即实数域上的Hermite矩阵为对称矩阵。



若$B^T = B$且$x^TBx > 0, (\forall_x \neq 0) \Longrightarrow \lambda_i > 0 (\forall_i)$，则存在矩阵$C, C^TC=E$，使得
$$
B = C \operatorname{diag}(\lambda_1, \lambda_2, \dots, \lambda_n)C^T \\
= C \operatorname{diag}(\sqrt{\lambda_1}, \sqrt{\lambda_2}, \cdots, \sqrt{\lambda_{n}}) \cdot \operatorname{diag}(\sqrt{\lambda_1}, \sqrt{\lambda_2}, \cdots, \sqrt{\lambda_{n}}) C^T = P^T P
$$
其中$P$是可逆矩阵。

将$E = C^TC$插入两个对角阵中间，等式依然成立
$$
B = C \operatorname{diag}(\sqrt{\lambda_1}, \sqrt{\lambda_2}, \cdots, \sqrt{\lambda_{n}}) C^TC \operatorname{diag}(\sqrt{\lambda_1}, \sqrt{\lambda_2}, \cdots, \sqrt{\lambda_{n}}) C^T \\
=P^TC^T \cdot CP =  QQ^T = QQ = Q^2
$$
即$Q^T = Q$，且$Q = C \operatorname{diag}(\sqrt{\lambda_1}, \sqrt{\lambda_2}, \cdots, \sqrt{\lambda_{n}})C^T$，即$Q$与$\operatorname{diag}(\sqrt{\lambda_1}, \sqrt{\lambda_2}, \cdots, \sqrt{\lambda_{n}})$相似，从而$Q$为正定矩阵。

当把$\lambda_i$展开成$\sqrt[k]{\lambda_i}$时，$Q = C \operatorname{diag}(\sqrt[k]{\lambda_1}, \sqrt[k]{\lambda_2}, \cdots, \sqrt[k]{\lambda_{n}})C^T$，也是正定矩阵。

==结论==：

（1）$B = P^TP$（$P$为可逆矩阵）

（2）$B = Q^k$（$Q^T = Q$且正定）



==广义特征值问题的简化==：

（1）当$B$可逆时，$Ax = \lambda Bx \Longrightarrow B^{-1}Ax = \lambda x$；

（2）当$A, B$都是Hermite矩阵，即$A = A^H, B = B^H$且$B$正定时，有$Qy = \lambda y$，其中$Q = (P^{-1})^HAP^{-1}, y = Px, B = P^HP$。

即求出$Qy = \lambda y$的特征值和特征向量后，$\lambda$即为原广义特征值问题的特征值，$x = P^{-1}y$为属于特征值$\lambda$的特征向量。



证明：$B = B^H$且正定，则存在可逆矩阵$P$，使得$B = P^HP$。从而$Ax = \lambda Bx$可化为$Ax = \lambda P^HP x$，记$y = Px$，则$x = P^{-1}y$，从而$(P^{-1})^H A P^{-1} y = \lambda y$，记$Q = (P^{-1})^H A P^{-1}$，则$Qy = \lambda y$，证毕！



由$Q = (P^{-1})^HAP^{-1}$，$A^H = A$，则$Q^H = (P^{-1})^H A^H P^{-1} = (P^{-1})^H A P^{-1} = Q$，从而$Q$矩阵也是Hermite矩阵。



由$Qy = \lambda y$，对于特征值$\lambda_i$和特征向量$y_i$，有$Q y_i = \lambda_i y_i, (i=1, 2, \cdots, n)$。因为$Q^H = Q$，所以存在标准正交基$y_1, y_2, \cdots, y_n$，$y_i^H y_j = \delta_{ij}$。而$y_i = Px_i$，则$y_i^H y_j = (Px_i)^H(Px_j) = x_i^H (P^HP)x_j = x_i^H B x_j = \delta_{ij}$，其中
$$
x_i^H Bx_j = \delta_{ij} = \left\{\begin{array}{cc}1, &j=i \\ 0, &j\neq i\end{array}\right.
$$
当$x_i^H B x_j = \delta_{ij}$时，则称$x_1, x_2, \cdots, x_n$为$B$的共轭向量系。



==定义4==：若$A \in C^{n \times n}$，$A^HA = E$，则称矩阵$A$为酉矩阵。



==求线性方程组的变分思想==：$Ax^\star = b$，通过构造函数$\phi(x) = \frac{1}{2}x^TAx - x^Tb$，将原方程转化为求函数$\phi(x)$的极值点，即求$\nabla \phi(x) = Ax - b = 0$。





==定理1==：设$n \times n$矩阵$A = A^H, B = B^H$且$B$正定，则$B$共轭向量系$x_1, x_2, \cdots, x_n$具有以下性质：

（1）$x_i \neq 0, (i=1,2,\cdots,n)$；

（2）$x_1, x_2, \cdots, x_n$线性无关；

（3）$\lambda_i$与$x_i$满足方程$Ax_i = \lambda_i B x_i$；

（4）若令$X = (x_1, x_2, \cdots, x_n)$，$X^H B X = E, X^HAX = \operatorname{diag}(\lambda_1, \lambda_2, \cdots, \lambda_n)$。



==联合对角化==：设有矩阵$A_1, A_2, \cdots, A_s$，寻找矩阵$P$，使得$P^H A_i P = \Lambda_i, (i=1,2,\cdots,s)$。

显然广义特征值问题也是联合对角化问题，即$A_1 = A, A_2 = B$。





## 第4节 内积空间

### 一、欧氏空间和酉空间

$$
\left\{\begin{array}{ccc}V(P) &\to &P上的线性空间 \\ (\cdot, \cdot) &\to &内积（特殊的二元函数）\end{array}\right. \Longrightarrow V为P上的内积空间
$$

==内积==：$V \to P$上的二元函数（或$V \times V \to P$）：$f(\cdot, \cdot) = (\cdot, \cdot)$满足：

（1）$\forall_{\alpha, \beta} \in V, f(\alpha, \beta) = k \in P$。

（2）==双线性==：$\forall_{x, y, x_1, y_1, x_2, y_2} \in V, \forall_{a_1, a_2} \in P$
$$
\left\{\begin{array}{cccc}f(x, a_1y_1 + a_2y_2) &= &a_1 f(x, y_1) + a_2f(x, y_2) &线性 \\ f(a_1x_1+a_2x_2, y) &= &\overline{a_1}f(x_1, y) + \overline{a_2}f(x_2, y) &共轭线性\end{array}\right.
$$
线性+共轭线性=双线性。$\overline{a_i}$指的是$a_i$的共轭复数。

（3）正定性与对称性：
$$
\left\{\begin{array}{ccc}f(x, y) &= &\overline{f(y, x)} &对称性 \\ f(x, x) &\ge &0 &正定性（f(x, x)=0当且仅当x=0）\end{array}\right.
$$

**注**：

（1）$P = R$，内积空间称为Euclid空间；

（2）$P = C$，内积空间称为酉空间。



==欧氏空间==：

==定义1==：在线性空间$V_n(R)$上，$\forall_{\alpha, \beta, \gamma} \in V$，若映射$(\alpha, \beta)$满足：

（1）正定性：$(\alpha, \alpha) \ge 0$，$(\alpha, \alpha) = 0 \Longleftrightarrow \alpha = 0$；

（2）齐次性：$(k\alpha, \beta) = k(\alpha, \beta)$；

（3）交换律：$(\alpha, \beta) = (\beta, \alpha)$；

（4）分配律：$(\alpha + \beta, \gamma) = (\alpha, \gamma) + (\beta, \gamma)$。

则映射$(\alpha, \beta)$是$V_n(R)$上的内积，定义了内积的线性空间$V$为$n$维欧几里得空间，简称欧氏空间。



==酉空间==：

==定义2==：在线性空间$V_n (C)$上，$\forall_{\alpha, \beta, \gamma} \in V$，若映射$(\alpha, \beta)$满足：

（1）正定性：$(\alpha, \alpha) \ge 0$，$(\alpha, \alpha) = 0 \Longleftrightarrow \alpha = 0$；

（2）齐次性：$(k\alpha, \beta) = \overline{k}(\alpha, \beta)$；

（3）交换律：$(\alpha, \beta) = \overline{(\beta, \alpha)}$；

（4）分配律：$(\alpha + \beta, \gamma) = (\alpha, \gamma) + (\beta, \gamma)$。

则映射$(\alpha, \beta)$是$V_n(C)$上的内积，定义了内积的线性空间$V$为$n$维酉空间。



**注意**：这里的线性空间是一个抽象的空间，其元素不仅仅局限于线性代数里面的向量或者矩阵。



例1：$C[a, b]$表示在$[a, b]$上所有实连续函数的全体组成的集合，其构成$R$上的线性空间，$\forall_{f(x), g(x)} \in C[a, b]$，规定：$(f(x), g(x)) = \int_a^b f(x)g(x)dx$。证明$C[a, b]$是欧氏空间。

证：$\forall_{f(x), g(x)} \in C[a, b]$，$\int_a^b f(x)g(x)dx$是唯一确定的实数。

（1）$(f, f) = \int_a^b f(x)f(x)dx = \int_a^b f^2(x)dx \ge 0$，且$\int_a^b f^2(x)dx = 0 \Longleftrightarrow f(x) = 0$；

（2）$(kf, g) = \int_a^b kf(x)g(x)dx = k\int_a^b f(x)g(x)dx = k(f,g)$；

（3）$(f,g) = \int_a^b f(x)g(x)dx = \int_a^b g(x)f(x)dx = (g, f)$；

（4）$(f+g, h) = \int_a^b [f(x)+g(x)]h(x)dx = \int_a^b f(x)h(x)dx + \int_a^b g(x)h(x)dx = (f,h)+(g,h)$。



例2：$V(R) = R^{n \times n}$，若规定内积如下$\forall_{A, B} \in V, (A, B) = \sum_{j=1}^n\sum_{i=1}^n a_{ij}b_{ij} = \tr(A^TB)$，即矩阵$A,B$的Hadamard积。
$$
\begin{aligned}
\boldsymbol{A}^{T} \boldsymbol{B}=\left(\begin{array}{cccc}
a_{11} & a_{21} & \cdots & a_{n 1} \\
a_{12} & a_{22} & \cdots & a_{n 2} \\
\vdots & \vdots & & \vdots \\
a_{1 n} & a_{2 n} & \cdots & a_{n n}
\end{array}\right)\left(\begin{array}{cccc}
b_{11} & b_{12} & \cdots & b_{1 n} \\
b_{21} & b_{22} & \cdots & b_{2 n} \\
\vdots & \vdots & & \vdots \\
b_{n 1} & b_{n 2} & \cdots & b_{n n}
\end{array}\right) \\
=\left(\begin{array}{cccc}
\sum_{i=1}^{n} a_{i 1} b_{i 1} & * & \cdots & * \\
* & \sum_{i=1}^{n} a_{i 2} b_{i 2} & \cdots & * \\
\vdots & \vdots & & \vdots \\
* & * & \cdots & \sum_{i=1}^{n} a_{i n} b_{i n}
\end{array}\right) \\
\Rightarrow(A, B)=\sum_{j=1}^{n} \sum_{i=1}^{n} a_{i j} b_{i j}=\operatorname{tr}\left(A^{T} B\right)
\end{aligned}
$$


证：

（1）$(A, A) = \tr(A^TA) = \sum_{j=1}^n\sum_{i=1}^n a_{ij}a_{ij} = \sum_{j=1}^n\sum_{i=1}^n a_{ij}^2 \ge 0$，$(A, A) = 0 \Longleftrightarrow a_{ij} = 0, (i, j=1,2,\cdots,n) \Longleftrightarrow A = 0$；

（2）$(A, B) = \sum_{j=1}^n\sum_{i=1}^n a_{ij}b_{ij} = \sum_{j=1}^n\sum_{i=1}^n b_{ij}a_{ij} = (B, A)$；

（3）$(kA, B) = \tr[(kA)^T B] = \tr(kA^TB) = k\tr(A^TB) = k(A, B)$；

（4）$(A+B, C) = \tr[(A+B)^TC] = \tr(A^TC + B^TC) = \tr(A^TC) + \tr(B^TC) = (A, C) + (B, C)$。



例3：$\forall_{\alpha = [a_1, a_2, \cdots, a_n]^T, \beta = [b_1, b_2, \cdots, b_n]^T, \gamma = [r_1,r_2,\cdots,r_n]^T} \in R^n$，若规定$(\alpha, \beta) = \sum_{i=1}^n a_i b_i$，则$(\alpha, \beta)$定义了一个内积，$R^n$是内积空间。

证：

（1）$(\alpha, \alpha) = \sum_{i=1}^n a_i a_i = \sum_{i=1}^n a_i^2 \ge 0$，$(\alpha, \alpha) = 0 \Longleftrightarrow \alpha = 0$；

（2）$(k\alpha, \beta) = \sum_{i=1}^n ka_i b_i = k\sum_{i=1}^n a_i b_i = k(\alpha, \beta)$；

（3）$(\alpha, \beta) = \sum_{i=1}^n a_i b_i = \sum_{i=1}^n b_i a_i = (\beta, \alpha)$；

（4）$(\alpha+\beta, \gamma) = \sum_{i=1}^n (a_i+b_i) r_i = \sum_{i=1}^n a_i r_i + \sum_{i=1}^n b_i r_i = (\alpha, \gamma) + (\beta, \gamma)$。



例4：$V(R) = R^n$，若规定内积如下：$\forall_{\alpha = [a_1,a_2,\cdots,a_n]^T, \beta = [b_1,b_2,\cdots,b_n]^T, \gamma = [r_1,r_2,\cdots,r_n]^T} \in V, \forall_k \in R, (\alpha, \beta) = \sum_{i=1}^n ia_i b_i$，则$(\alpha, \beta)$定义了一个内积，$R^n$是内积空间。

证：

（1）$(\alpha, \alpha) = \sum_{i=1}^n i a_i a_i = \sum_{i=1}^n i a_i^2 \ge 0$，$(\alpha, \alpha) = 0 \Longleftrightarrow \alpha = 0$；

（2）$(\alpha, \beta) = \sum_{i=1}^n i a_i b_i = \sum_{i=1}^n i b_i a_i = (\beta, \alpha)$；

（3）$(k\alpha, \beta) = \sum_{i=1}^n i ka_i b_i = k\sum_{i=1}^n i a_i b_i = k(\alpha, \beta)$；

（4）$(\alpha+\beta, \gamma) = \sum_{i=1}^n i (a_i+b_i) r_i = \sum_{i=1}^n (i a_i r_i + ib_i r_i) = \sum_{i=1}^n i a_i r_i + \sum_{i=1}^n i b_i r_i = (\alpha, \gamma) + (\beta, \gamma)$。



==总结==：由例3、例4，有$(\alpha, \beta) = \alpha^T E \beta$，$(\alpha, \beta) = \alpha^T \Lambda B$都是内积。当矩阵$A$满足什么条件时，$(\alpha, \beta) = \alpha^T A \beta$是内积？

由于对任意矩阵$A$，$(\alpha, \beta) = \alpha^T A \beta$都满足齐次性和分配律，所以只需要再满足正定性和交换律即可。

（1）$\forall_\alpha \in R^n$，$(\alpha, \alpha) = \alpha^T A \alpha \ge 0$且$(\alpha, \alpha) = \alpha^T A \alpha \Longleftrightarrow \alpha = 0$，说明$A$是正定矩阵。

（2）$\forall_{\alpha, \beta} \in R^n$，由于$(\alpha, \beta)$是$R^n \times R^n \to R$，所以$(\alpha, \beta)^T = (\alpha, \beta)$，即$(\alpha^T A \beta)^T = \beta^T A^T \alpha = \alpha^T A \beta$，又因为$(\alpha, \beta)$需要满足交换律，则$(\alpha, \beta) = \alpha^T A \beta = \beta^T A^T \alpha = \beta^T A \alpha = (\beta, \alpha)$，从而$\beta^T (A^T - A)\alpha = 0$。由$\alpha, \beta$的任意性，当$\beta = e_i, \alpha = e_j$时，$\beta^T (A^T - A)\alpha = 0$依然成立，即$e_i^T (A^T - A)e_j = 0$，从而$(A^T - A)_{ij} = 0$，因此$A^T = A$。



例5：$\forall_\alpha = [a_1,a_2,\cdots,a_n]^T, \beta = [b_1,b_2,\cdots,b_n]^T \in C^n$，若规定$(\alpha, \beta) = \alpha^H\beta = \sum_{i=1}^n \overline{a_i}b_i$，则$(\alpha, \beta)$定义了一个内积，此时$C^n$是酉空间。



### 二、欧氏（酉）空间的度量——内积诱导的度量

==定义1==：设$V$是欧氏（酉）空间，$\forall_\alpha \in V$，$\alpha$的长度定义为$\norm{\alpha} = \sqrt{(\alpha, \alpha)}$。



==长度的公理化定义==：

（1）$\norm{\alpha} \ge 0$，且$\norm{\alpha} = 0 \Longleftrightarrow \alpha = 0$。

（2）$\norm{\lambda \alpha} = |\lambda|\norm{\alpha}$。

（3）$\norm{\alpha+\beta} \le \norm{\alpha} + \norm{\beta}$。





==定理1==：设$V$是$n$维欧氏（酉）空间，则向量长度具有以下的性质：

（1）$\norm{\alpha} \ge 0$，$\norm{\alpha} = 0 \Longleftrightarrow \alpha = 0$。

证：显然$\norm{\alpha} = \sqrt{(\alpha, \alpha)} \ge 0$，且$\norm{\alpha} = 0 \Longleftrightarrow \sqrt{(\alpha, \alpha)} = 0 \Longleftrightarrow \alpha = 0$；

（2）$\norm{k\alpha} = |k|\norm{\alpha}$。

证：$\norm{k\alpha} = \sqrt{(k\alpha, k\alpha)} = \sqrt{\overline{k}k(\alpha, \alpha)} = \sqrt{|k|^2(\alpha, \alpha)} = |k|\norm{\alpha}$。

（3）$\norm{\alpha+\beta} \le \norm{\alpha} + \norm{\beta}$。

（4）$|(\alpha, \beta)| \le \norm{\alpha} \cdot \norm{\beta}$，等号成立的充要条件是$\alpha, \beta$线性相关。



证（3）（4）：

由$\norm{\alpha + \beta} \le \norm{\alpha} + \norm{\beta}$$\Longleftrightarrow \sqrt{(\alpha+\beta,\alpha+\beta)} \le \norm{\alpha}+\norm{\beta}$$\Longleftrightarrow$$(\alpha+\beta,\alpha+\beta) \le (\norm{\alpha}+\norm{\beta})^2$$\Longleftrightarrow$$(\alpha+\beta,\alpha+\beta) \le \norm{\alpha}^2 + 2\norm{\alpha}\norm{\beta} + \norm{\beta}^2$，而$(\alpha, \alpha+\beta) + (\beta, \alpha+\beta) = \overline{(\alpha, \alpha) + (\beta, \alpha)} + \overline{(\alpha, \beta)+(\beta, \beta)} = \norm{\alpha}^2 + \norm{\beta}^2 + 2\operatorname{Re} (\alpha, \beta) \le \norm{\alpha}^2+\norm{\beta}^2+2|(\alpha, \beta)|$，

所以原问题可转化为证明：$|(\alpha, \beta)| \le \norm{\alpha} \cdot \norm{\beta}$。



（空间$V$是欧氏空间）当$\alpha, \beta$线性无关时，设有$t \in R$，$u = \alpha + t\beta \neq 0$，从而
$$
0 < (u, u) = (\alpha + t\beta, \alpha + t\beta) = (\alpha, \alpha+t\beta) + (t\beta, \alpha + t\beta) = (\alpha, \alpha) + t(\alpha, \beta) + t(\alpha, \beta) + t^2(\beta, \beta) \\
= t^2 (\beta, \beta) + 2(\alpha,\beta) t + (\alpha, \alpha)
$$
即$(u, u) = f(t) = at^2 + bt +c$，因为$a > 0$，所以二次函数开口向上，又因$f(t) > 0$，则判别式$b^2 - 4ac < 0$，即$4(\alpha, \beta)^2 \le 4 (\alpha, \alpha)(\beta, \beta)$，从而$|(\alpha, \beta)| < \norm{\alpha} \norm{\beta}$。

当$\alpha, \beta$线性相关时，$\beta = t\alpha$，$(\alpha, \beta)^2 = (\alpha, t\alpha)^2 = t^2 (\alpha, \alpha)^2$，$(\alpha, \alpha)(\beta, \beta) = (\alpha, \alpha)(t\alpha, t\alpha) = t^2(\alpha, \alpha)^2$，即$(\alpha, \beta)^2 = (\alpha, \alpha)(\beta, \beta)$，从而$|(\alpha, \beta)| = \norm{\alpha}\norm{\beta}$。



（空间$V$是酉空间）若$\beta = 0$，不等式显然成立。现设$\beta \neq 0$，则
$$
0 \le \norm{\alpha - k\beta}^2 = (\alpha - k\beta, \alpha-k\beta) = (\alpha, \alpha-k\beta) + (-k\beta, \alpha-k\beta) \\
= \overline{(\alpha, \alpha) + (-k\beta, \alpha)} + \overline{(\alpha, -k\beta) + (-k\beta, -k\beta)} \\
= (\alpha, \alpha) - k(\alpha, \beta) -\overline{k} (\beta, \alpha) + k\overline{k}(\beta, \beta)
$$
在上式中，令$k = \frac{(\beta, \alpha)}{(\beta, \beta)}$，得$0 \le (\alpha, \alpha) - \frac{|(\alpha, \beta)|^2}{(\beta, \beta)} - \frac{|(\alpha, \beta)|^2}{(\beta, \beta)} + \frac{|(\alpha, \beta)|^2}{(\beta, \beta)} = (\alpha, \alpha) - \frac{|(\alpha, \beta)|^2}{(\beta, \beta)} = \norm{\alpha}^2 - \frac{|(\alpha, \beta)|^2}{\norm{\beta}^2}$，即$|(\alpha, \beta)| \le \norm{\alpha} \norm{\beta}$。



==定义2==：向量$x$与$y$的距离定义为$d(x, y) = \norm{x- y}$。



由$|(\alpha, \beta)| \le \norm{\alpha}\cdot\norm{\beta}$，得$\frac{|(\alpha, \beta)|}{\norm{\alpha}\cdot\norm{\beta}} \le 1$，即$-1 \le \frac{(\alpha, \beta)}{\norm{\alpha} \cdot \norm{\beta}} \le 1$，这与三角函数的值域相同，令$\frac{(\alpha, \beta)}{\norm{\alpha} \cdot \norm{\beta}} = \cos\theta$，则$<\alpha, \beta> \triangleq \theta = \arccos \frac{(\alpha, \beta)}{\norm{\alpha} \cdot \norm{\beta}}$。

==定义3==：设$\alpha, \beta$是欧氏空间$V$的两个非零向量，它们之间的夹角定义为$<\alpha, \beta> = \arccos\frac{(\alpha, \beta)}{\norm{\alpha}\cdot\norm{\beta}}$。



==定义4（两个向量正交）==：$(x, y) = 0$$\Longleftrightarrow$向量$x$与向量$y$正交，记为$x \perp y$。



==柯西不等式的的表现形式==：

例1：设$V = R^n$，$\forall_{x = [x_1,x_2,\cdots,x_n]^T,y=[y_1,y_2,\cdots,y_n]^T} \in V$，

（1）$(x, y) = x^Ty = \sum_{i=1}^n x_iy_i \Longrightarrow |\sum_{i=1}^n x_iy_i| \le (\sum_{i=1}^n x_i^2)^\frac{1}{2} \cdot (\sum_{i=1}^n y_i^2)^\frac{1}{2}$；

（2）$(x, y) = \sum_{i=1}^n ix_iy_i \Longrightarrow |\sum_{i=1}^n ix_iy_i| \le (\sum_{i=1}^n ix_i^2)^\frac{1}{2} \cdot (\sum_{i=1}^n iy_i^2)^\frac{1}{2}$。



例2：设$V = C[a, b]$（闭区间$[a, b]$上所有实连续函数组成的集合），$\forall_{f(x), g(x)} \in V$，若定义内积$(f(x), g(x)) = \int_a^b f(x)g(x)dx$，则有$|\int_a^b f(x)g(x)dx| \le (\int_a^b f^2(x)dx)^{\frac{1}{2}} \cdot (\int_a^b g^2(x)dx)^{\frac{1}{2}}$。



例3：设$V = R^{n \times n}$，$\forall_{A, B} \in V$，定义内积$(A, B) = \tr(A^TB)$，则有$|\tr (A^TB)| \le [\tr (A^TA)]^{\frac{1}{2}} \cdot [\tr(B^TB)]^{\frac{1}{2}}$。



例4：设$V = R^2$，$x = [1, 1]^T, y = [3, -2]^T$，则

（1）在内积$(x, y) = x^Ty$下，$(x, y) = x^Ty = [1, 1] \cdot [3, -2]^T = 1 \neq 0$，从而$x$与$y$不是正交的；

（2）设$A = \left[\begin{array}{cc}1 &1 \\ 1 & 2\end{array}\right]$，在内积$(x, y) = x^TAy$下，$(x, y) = x^TAy = [1, 1] \cdot \left[\begin{array}{cc}1 &1 \\ 1 & 2\end{array}\right] \cdot [3, -2]^T = 0$，从而$x$与$y$正交。



==小结==：从上述的例子可以看出，两个向量是否正交，不再局限于线性代数中内积$(x, y) = x^Ty = 0$的定义，而是与内积的定义有关。



### 三、内积的应用

设$V$是一个内积空间，$\forall_{\alpha_1, \alpha_2, \cdots, \alpha_k} \in V$ ，
$$
A(\alpha_1, \alpha_2, \cdots, \alpha_k) = [(\alpha_i, \alpha_j)]_{k \times k} = (\alpha_{ij})_{k \times k} \\
= \left[\begin{array}{cccc}(\alpha_1, \alpha_1) &(\alpha_1, \alpha_2) &\cdots &(\alpha_1, \alpha_k) \\ (\alpha_2, \alpha_1) &(\alpha_2, \alpha_2) &\cdots &(\alpha_2, \alpha_k) \\ \vdots &\vdots &\ddots &\vdots \\ (\alpha_k, \alpha_1) &(\alpha_k, \alpha_2) &\cdots &(\alpha_k, \alpha_k)\end{array}\right]
$$
其中$a_{ij} = (a_i, a_j)$，该矩阵称为格拉姆（Gram）矩阵。

$G(\alpha_1, \alpha_2, \cdots, \alpha_k) = \det A(\alpha_1, \alpha_2, \cdots, \alpha_k)$称为格拉姆（Gram）行列式。



当数域$P = R$时，$a_{ij} = a_{ji}$，格拉姆矩阵是对称矩阵；

当数域$P = C$时，$a_{ij} = \overline{a_{ji}}$，格拉姆矩阵是Hermite矩阵。



==格拉姆（Gram）矩阵的性质==：

（1）若$\alpha_1, \alpha_2, \cdots, \alpha_k$线性相关$\Longleftrightarrow$$A(\alpha_1, \alpha_2, \cdots, \alpha_k)$奇异（不可逆）$\Longleftrightarrow$$G(\alpha_1, \alpha_2, \cdots, \alpha_k) = 0$；

（2）若$\alpha_1, \alpha_2, \cdots, \alpha_k$线性无关$\Longleftrightarrow$$A(\alpha_1, \alpha_2, \cdots, \alpha_k)$非奇异（可逆）$\Longleftrightarrow$$G(\alpha_1, \alpha_2, \cdots, \alpha_k) \neq 0$。



证：设$x = [x_1, x_2, \cdots, x_k]^T$，且$\sum_{i=1}^k x_i \alpha_i = 0$，对$\alpha_l, (l = 1,2,\cdots,k)$，$(\alpha_l, \sum_{i=1}^k x_i \alpha_i) = \sum_{i=1}^k x_i (\alpha_l, \alpha_i) =  (\alpha_l, 0) = 0$，写成矩阵形式，即
$$
\left[\begin{array}{cccc}(\alpha_1, \alpha_1) &(\alpha_1, \alpha_2) &\cdots &(\alpha_1, \alpha_k) \\ (\alpha_2, \alpha_1) &(\alpha_2, \alpha_2) &\cdots &(\alpha_2, \alpha_k) \\ \vdots &\vdots &\ddots &\vdots \\ (\alpha_k, \alpha_1) &(\alpha_k, \alpha_2) &\cdots &(\alpha_k, \alpha_k)\end{array}\right] \left[\begin{array}{c}x_1 \\ x_2 \\ \vdots \\ x_k\end{array}\right] = \left[\begin{array}{c}0 \\ 0 \\ \vdots \\ 0\end{array}\right]
$$
（1）$\alpha_1, \alpha_2, \cdots, \alpha_k$线性无关$\Longleftrightarrow$$x = 0$$\Longrightarrow$$A$可逆$\Longleftrightarrow$$\det(A) \neq 0$$\Longleftrightarrow$$G(\alpha_1, \alpha_2, \cdots, \alpha_k) \neq 0$；

（2）$\alpha_1, \alpha_2, \cdots, \alpha_k$线性相关$\Longleftrightarrow$$x \neq 0$$\Longrightarrow$$A$不可逆$\Longleftrightarrow$$\det(A) = 0$$\Longleftrightarrow$$G(\alpha_1, \alpha_2, \cdots, \alpha_k) = 0$。



==基的格拉姆矩阵（度量矩阵）==：

（1）设$V_n$是$n$维欧氏空间，且$\epsilon_1, \epsilon_2, \cdots, \epsilon_n$为$V_n(R)$的基，即$V_n(R) = \operatorname{span}\{\epsilon_1, \epsilon_2, \cdots, \epsilon_n\}$，则$A = (A_{ij})_{n \times n}$，（其中$a_{ij} = (\epsilon_i, \epsilon_j)$），称为度量矩阵。可知$A = (a_{ij})$ 可逆。

（2）$\forall_{\alpha, \beta} \in V_n(R)$，有$\alpha = \sum_{i=1}^n x_i \epsilon_i, \beta = \sum_{i=1}^n y_i \epsilon_i$，从而$(\alpha, \beta) = (\sum_{i=1}^n x_i \epsilon_i, \sum_{i=1}^n y_i\epsilon_i) = \sum_{i=1}^n x_i (\epsilon_i, \sum_{j=1}^n y_j \epsilon_j) = \sum_{i=1}^n x_i \sum_{j=1}^n y_j(\epsilon_i, \epsilon_j) = \sum_{i=1}^n \sum_{j=1}^n x_i y_j (\epsilon_i, \epsilon_j) = \sum_{i=1}^n \sum_{j=1}^n x_i y_j a_{ij}$（其中$a_{ij} = (\epsilon_i, \epsilon_j)$）。构造矩阵和列向量：
$$
A = \left[\begin{array}{cccc}(\epsilon_1, \epsilon_1) &(\epsilon_1, \epsilon_2) &\cdots &(\epsilon_1, \epsilon_n) \\ (\epsilon_2, \epsilon_1) &(\epsilon_2, \epsilon_2) &\cdots &(\epsilon_2, \epsilon_n) \\ \vdots &\vdots &\ddots &\vdots \\ (\epsilon_n, \epsilon_1) &(\epsilon_n, \epsilon_2) &\cdots &(\epsilon_n, \epsilon_n)\end{array}\right], x = \left[\begin{array}{c}x_1 \\ x_2 \\ \vdots \\ x_n\end{array}\right], y = \left[\begin{array}{c}y_1 \\ y_2 \\ \vdots \\ y_n\end{array}\right]
$$
从而$(\alpha, \beta) = x^T A y$。

（3）$\forall_{\alpha \neq 0} \in V_n(R)$，$\alpha = [\epsilon_1, \epsilon_2, \cdots, \epsilon_n]x$，$(\alpha, \alpha) = x^T A x > 0$，从而$A$是正定矩阵；同理在酉空间里有$(\alpha, \alpha) = x^H A x > 0$成立。



==大规模计算应用举例==：

设$V = P_2[x] = \{a_0 + a_1 x + a_2x^2, a_i \in R\}$，线性空间$V$的基为$1, x, x^2$，$\forall_{f(x), g(x)} \in V$，定义内积$(f(x), g(x)) = \int_{-1}^{1}f(x)g(x)dx$。

（1）求基$1, x, x^2$的度量矩阵。

（2）设$f(x) = 1 - x + x^2$，$g(x) = 1 - 4x - 5x^2$，求$\int_{-1}^{1} f(x)g(x)dx$。



解：

（1）$(1, 1) = \int_{-1}^{1} 1 \cdot 1 dx = 2$，$(1, x) = \int_{-1}^{1} 1 \cdot x dx = 0$，$(1, x^2) = \int_{-1}^{1} 1 \cdot x^2 dx = \frac{2}{3}$，$(x, x) = \int_{-1}^{1} x \cdot x dx = \frac{2}{3}$，$(x, x^2) = \int_{-1}^{1} x \cdot x^2 dx = 0$，$(x^2, x^2) = \int_{-1}^{1} x^2 \cdot x^2 dx = \frac{2}{5}$。所以基$1, x, x^2$的度量矩阵为：
$$
A(1, x, x^2) = \left[\begin{array}{ccc}2 &0 &\frac{2}{3} \\ 0 &\frac{2}{3} &0 \\ \frac{2}{3} &0 &\frac{2}{5}\end{array}\right]
$$
（2）$\alpha = f(x) = 1 - x + x^2 = [1, x, x^2]\left[\begin{array}{c}1 \\ -1 \\ 1\end{array}\right]$，$\beta = g(x) = 1 - 4x - 5x^2 = [1, x, x^2]\left[\begin{array}{c}1 \\ -4 \\ -5\end{array}\right]$，令$u = \left[\begin{array}{c}1 \\ -1 \\ 1\end{array}\right]$，$v = \left[\begin{array}{c}1 \\ -4 \\ -5\end{array}\right]$，则
$$
\int_{-1}^{1} f(x)g(x)dx = (f(x), g(x)) = (\alpha, \beta) = u^T A v \\
= \left[\begin{array}{ccc}1 &-1 &1\end{array}\right]\left[\begin{array}{ccc}2 &0 &\frac{2}{3} \\ 0 &\frac{2}{3} &0 \\ \frac{2}{3} &0 &\frac{2}{5}\end{array}\right]\left[\begin{array}{c}1 \\ -4 \\ -5\end{array}\right] = 0
$$


==线性空间不同基的度量矩阵之间的关系==：

设线性空间$V$的一组基为$\epsilon_1, \epsilon_2, \cdots, \epsilon_n$，度量矩阵为$A$，另一组基为$\epsilon_1^\prime, \epsilon_2^\prime, \cdots, \epsilon_n^\prime$，度量矩阵为$B$，两组基的过渡矩阵为$C$，即$[\epsilon_1^\prime, \epsilon_2^\prime, \cdots, \epsilon_n^\prime] = [\epsilon_1, \epsilon_2, \cdots, \epsilon_n]C$，$\alpha, \beta \in V$，且$\alpha$在基$\epsilon_1, \epsilon_2, \cdots, \epsilon_n$下的坐标为$x = [x_1, x_2, \cdots, x_n]^T$，在基$\epsilon_1^\prime, \epsilon_2^\prime, \cdots, \epsilon_n^\prime$下的坐标为$x^\prime = [x_1^\prime, x_2^\prime, \cdots, x_n^\prime]^T$，$\beta$在基$\epsilon_1, \epsilon_2, \cdots, \epsilon_n$下的坐标为$y = [y_1, y_2, \cdots, y_n]^T$，在基$\epsilon_1^\prime, \epsilon_2^\prime, \cdots, \epsilon_n^\prime$下的坐标为$y^\prime = [y_1^\prime, y_2^\prime, \cdots, y_n^\prime]^T$，则：
$$
x &\nwarrow & &\swarrow &\alpha &\searrow &\ &\nearrow &x^\prime\\
(\alpha, \beta)=x^TAy & & \epsilon_1, \epsilon_2, \cdots, \epsilon_n & &\ &\  &\epsilon_1^\prime, \epsilon_2^\prime, \cdots, \epsilon_n^\prime &\ &(\alpha, \beta)={x^\prime}^TBy^\prime \\
y &\swarrow & &\nwarrow &\beta &\nearrow &\ &\searrow &y^\prime
$$
$[\epsilon_1, \epsilon_2, \cdots, \epsilon_n]x = \alpha = [\epsilon_1^\prime, \epsilon_2^\prime, \cdots, \epsilon_n^\prime]x^\prime = [\epsilon_1, \epsilon_2, \cdots, \epsilon_n]Cx^\prime$，$[\epsilon_1, \epsilon_2, \cdots, \epsilon_n]y = \beta = [\epsilon_1^\prime, \epsilon_2^\prime, \cdots, \epsilon_n^\prime]y^\prime = [\epsilon_1, \epsilon_2, \cdots, \epsilon_n]Cy^\prime$，从而$[\epsilon_1, \epsilon_2, \cdots, \epsilon_n](Cx^\prime-x) = 0, [\epsilon_1, \epsilon_2, \cdots, \epsilon_n](Cy^\prime-y) = 0$，则$Cx^\prime = x, Cy^\prime = y$，${x^\prime}^T B y^\prime = (\alpha, \beta) = x^TAy = (Cx^\prime)^T A (Cy^\prime) = {x^\prime}^T C^TAC y^\prime$，从而$B = C^TAC$。

**Tips**：在工程上可以选取计算量最小的一组基。

